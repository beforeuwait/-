# __关于提高爬虫组开展"反反爬虫"优先级的建议__

## __陈述__
为应对各大OTA近期集中出现的提升反爬虫策略的情况，应对这些反爬虫策略对后期数据采集的影响，同时保证数据继续正常采集，因此近期应该将当前的平台化开发工作重心转移到反反爬虫上，做到未雨绸缪。
> 主要矛盾:当前采集数据的特殊性，敏感性

因为采集的数据的特殊性，各OTA对自有数据的保护程度提升，造成集采的难度增加。

随着数据采集渠道的增加，并且各OTA反爬虫的策略的提升，按照现有的抓取策略，后期可采集的数据源必然呈下降趋势。

针对已有的反爬虫和即将到来的反爬虫措施，__反反爬虫__的优先级必须提高，因而当前的工作重心应该转移到__反反爬虫上__。

> __通过对当前的采集过的OTA数据进行观察，在涉及敏感数据部分，各OTA开始有意识的提升反爬虫的难度，主要体现在：__

- 涉及酒店数据中的反爬虫：
	- 房间信息采集：价格，房型等等
	- 评论数据采集：用户点评
- 涉及旅游线路数据中的反爬虫：
	- 各旅游线路产品的评论数据采集
- 涉及旅游云数据编目中的反爬虫:
	- 吃住行游购娱中的商铺基础数据采集
- 涉及到登录，包括滑动验证中的反爬虫
	
> 影响:

针对酒店基础数据的采集，包括房间信息，用户点评，受到较大的影响。

当前的已采集的OTA有：__艺龙，途牛，蚂蜂窝，大众点评，驴妈妈__

无法采集的OTA包括: __携程，同程，去哪儿，飞猪旅行__

开发中的OTA包括: __京东旅行，美团酒店__

主要的数据集中在: __艺龙，携程，同程，大众点评,去哪儿__

目前的爬虫组的同事观察的情况有：

- __艺龙酒店__开始在请求中放入token，但未正式部署，预期将来一旦部署，如不进行反反爬虫，数据无法采集
- __携程酒店__因为token的原因数据一直无法采集
- __去哪儿酒店__因为多js混淆融合数据无法采集
- __同程酒店__因为全局token的原因数据自8月份无法采集
- __大众点评__近期进行较大的迭代，当前的影响是无法通过api采集商铺的基础数据，预期大众点评将在全站内部署反爬虫措施
- __途牛，蚂蜂窝，驴妈妈__ 当前暂未发现明显的js对抗级别的反爬虫，但因为其数据量相比别的OTA少很多

> 预期:

__针对酒店数据的采集，难度将会空前的提升__

__针对大众点评类的基础数据采集，将会受到较大的影响，包括刚刚上线的美团网__

同时大众点评关于评论部分，一旦部署token，在现有的抓取策略里也将无法采集

爬虫组的同事们在先前的工作过程中缺少__反反爬虫__的经验，一旦各OTA大量更新__反爬虫__策略，将造成一定时间内的数据空窗期

## __建议:__

> 从数据采集角度:

需要开展__反反爬虫__的落实，将OTA之前未采集的数据进行扩充，同时在现有采集的OTA一旦升级反爬虫策略，也能较快的时间内相应并进行针对性的开发，以保证数据的不间断更新

> 从爬虫工程师技能角度:

笔者个人认为，在采集一定量数据积累一定经验后，挑战就是反爬虫，对抗这也是爬虫的魅力所在，因此，提升组内成员__反反爬虫__技能是很有必要的

因此:建议在下一个季度中，日常的脚本维护，新的采集任务外，应将主要精力投入到反反爬虫中，并制定一个可量化的时刻表，

## 附录
> __针对当前OTA已有数据和即将采集数据整理及反爬虫策略整理__

|OTA|   类别    |   是否反爬虫   |   反爬虫措施  | 难度评估  |    对抗方式   |
|---|----------|---------------|-------------|----------|-------------|
|携程网|酒店数据|存在反爬虫|每次请求通过js生成一个eleven参数，得到服务器认证从而拿到数据|高级|-|
|携程网|旅游行程|存在反爬虫|未出现明显token，在切换page对数据的url进行访问，返回401，证明显存在爬虫|高级|-|
|去哪儿|酒店数据|存在反爬虫|多个js混淆加密融合，输出页面结果|中级难度|-|
|同程网|酒店数据|存在反爬虫|贯穿在整个application中的antitoken，造成数据无法获取，页面也无法调试|顶级|-|
|飞猪网|全部分类|存在反爬虫|通过机器识别爬虫，效率很高|顶级|-|
|大众点评|店铺信息|存在反爬虫|不同的api通过js生成特定的token，多而复杂，疲于应对|顶级|-|